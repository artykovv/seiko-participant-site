{% extends "base.html" %}
{% block content %}

<div class="text-center mt-5">
    <h1>Реферальные бонусы</h1>
</div>

<div class="d-flex flex-wrap justify-content-evenly">
    <button type="button" class="btn btn-outline-primary btn-lg mt-3"  disabled>Бинар бонус</button>

    <a class="btn btn-primary btn-lg mt-3" style="background-color: #000080;" href="/rewards/referal">Реферальные</a>
    <a class="btn btn-primary btn-lg mt-3" style="background-color: #000080;" href="/rewards/cheque">Чек от чека</a>
    <a class="btn btn-primary btn-lg mt-3" style="background-color: #000080;" href="/rewards/status">Статусные</a>
    <a class="btn btn-primary btn-lg mt-3" style="background-color: #000080;" href="/rewards/sponsor">Спонсорские</a>
    
    <a class="btn btn-primary btn-lg mt-3" style="background-color: #000080;" href="/rewards/surprise">Неожиданный бонус</a>
    <a class="btn btn-primary btn-lg mt-3" style="background-color: #000080;" href="/rewards/tour">Туристический бонус</a>
    <a class="btn btn-primary btn-lg mt-3" style="background-color: #000080;" href="/rewards/auto">Автопрограмма</a>
</div>

<div class="round card mt-5" style="height: 100vh;">
    <div class="card-body">

        <table class="table fs-6">
            <thead>
              <tr>
                <th>Период</th>
                <th>Малая В </th>
                <th>Большая В</th>
                <th>Бонус</th>
                <th>Большая В</th>
              </tr>
            </thead>
            <tbody>
            </tbody>
          </table>
    </div>
</div>


<script>
    const SiteUrl = "{{ site_url_and_port }}";  // Адрес сайта
    const apiUrl = `${SiteUrl}/bonus/binar`;   // API эндпоинт
    const token = "{{ token }}";               // Токен авторизации
    
    // Функция для загрузки данных с API
    async function fetchBonusData() {
        try {
            const response = await fetch(apiUrl, {
                method: 'GET',
                headers: {
                    'Authorization': `Bearer ${token}`,
                    'Content-Type': 'application/json'
                }
            });
    
            if (!response.ok) {
                throw new Error(`Ошибка: ${response.status}`);
            }
    
            const data = await response.json(); // Получаем JSON
            renderTable(data);                  // Отображаем данные
        } catch (error) {
            console.error('Ошибка при загрузке данных:', error);
        }
    }
    
    // Функция для отображения данных в таблице
    function renderTable(data) {
        const tbody = document.querySelector('table tbody');
        tbody.innerHTML = ''; // Очистить существующее содержимое таблицы
    
        data.forEach(item => {
            const row = document.createElement('tr');
    
            row.innerHTML = `
                <td>${item.period}</td>
                <td>${item.small_volume}</td>
                <td>${item.big_volume}</td>
                <td><strong>${item.bonus_amount}<strong></td>
                <td>${item.big_branch_side === 'right' ? 'Правый' : 'Левый'}</td>
            `;
    
            tbody.appendChild(row);
        });
    }
    
    // Загрузка данных при загрузке страницы
    document.addEventListener('DOMContentLoaded', fetchBonusData);
    </script>
    
<style>
.btn:disabled{
    border-color: #000080;
    color: #000080;
}
</style>

{% endblock %}
